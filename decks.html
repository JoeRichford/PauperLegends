<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="style.css">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pauper Legends - Decks</title>
  <style>
  </style>
</head>
<body>

<!-- LEFT: Goreclaw -->
<div class="side-strip left">
  <div class="scroll-track">
    <img src="https://raw.githubusercontent.com/pauperlegends/PauperLegends/main/Goreclaw.jpg" alt="Goreclaw">
    <img src="https://raw.githubusercontent.com/pauperlegends/PauperLegends/main/Goreclaw.jpg" alt="Goreclaw">
  </div>
</div>

<!-- RIGHT: Juri -->
<div class="side-strip right">
  <div class="scroll-track">
    <img src="https://raw.githubusercontent.com/pauperlegends/PauperLegends/main/juri.jpg" alt="Juri">
    <img src="https://raw.githubusercontent.com/pauperlegends/PauperLegends/main/juri.jpg" alt="Juri">
  </div>
</div>

  <header>
    <h1>Pauper Legends</h1>
  </header>

  <nav>
    <a href="index.html">Home</a>
    <a href="decks.html">Decks</a>
    <a href="#tournaments">Tournaments</a>
    <a href="#rules">Rules</a>
    <a href="#banned">Banned</a>
    <a href="#news">News</a>
    <a href="#contact">Contact</a>
  </nav>

<div class="section">
  <h2>Deck Showcase</h2>
  <div id="decks-container"></div>
</div>

  <!-- ðŸ“Œ Fixed card image preview panel -->
  <div id="card-preview">
  <div id="preview-header">
    <button onclick="closePreview()">âœ–</button>
  </div>
  <div id="preview-content">
    <img id="preview-image" src="" alt="Card Image" />
    <div id="card-text">
      <h4 id="card-name"></h4>
      <p id="card-type"></p>
      <p id="card-oracle"></p>
    </div>
  </div>
</div>
    <span style="color: #999; font-size: 0.85rem;">Click a card to preview</span>
  </div>

  <footer>
    &copy; 2025 Pauper Legends. All rights reserved.
  </footer>

  <script>
  function toggleDeck(header) {
    const list = header.nextElementSibling;
    list.style.display = list.style.display === 'block' ? 'none' : 'block';
  }

  function showCardImage(event, cardName) {
    const preview = document.getElementById('card-preview');
    const img = document.getElementById('preview-image');
    const cardNameElem = document.getElementById('card-name');
    const cardTypeElem = document.getElementById('card-type');
    const oracleElem = document.getElementById('card-oracle');

    preview.style.display = 'flex';
    img.src = '';
    cardNameElem.textContent = 'Loading...';
    cardTypeElem.textContent = '';
    oracleElem.textContent = '';

    const encoded = encodeURIComponent(cardName);
    fetch(`https://api.scryfall.com/cards/named?exact=${encoded}`)
      .then(res => res.json())
      .then(data => {
        img.src = data.image_uris?.normal || '';
        cardNameElem.textContent = data.name || '';
        cardTypeElem.textContent = data.type_line || '';
        oracleElem.textContent = data.oracle_text || 'No description available.';
      })
      .catch(err => {
        cardNameElem.textContent = 'Card not found';
        cardTypeElem.textContent = '';
        oracleElem.textContent = '';
        img.src = '';
      });
  }

  function closePreview() {
    const preview = document.getElementById('card-preview');
    preview.style.display = 'none';
  }
</script>

<script>
  document.querySelectorAll('.deck-title').forEach(button => {
    button.addEventListener('click', () => {
      const cards = button.nextElementSibling;
      const isVisible = cards.style.display === 'block';
      cards.style.display = isVisible ? 'none' : 'block';
      button.textContent = isVisible
        ? button.textContent.replace('â–²', 'â–¼')
        : button.textContent.replace('â–¼', 'â–²');
    });
  });
</script>

<!-- Card Info Sidebar -->
<div id="card-info-panel" class="card-info-panel">
  <img id="card-img" src="" alt="Card Image" />
  <div id="card-details" class="card-details">
    <h3 id="card-name">Card Name</h3>
    <p id="card-mana-cost">Mana Cost: </p>
    <p id="card-type">Type: </p>
    <p id="card-text">Card Text: </p>
    <p id="card-author">Author: </p>
    <!-- Add any other fields you want here -->
  </div>
</div>

<script>
  async function loadDecks() {
    try {
      const response = await fetch('decks.json');
      const decks = await response.json();
      const container = document.getElementById('decks-container');
      container.innerHTML = '';

      decks.forEach(deck => {
        // Create deck wrapper
        const deckDiv = document.createElement('div');
        deckDiv.className = 'deck';

        // Create deck title as a button to toggle cards
        const deckTitle = document.createElement('button');
        deckTitle.className = 'deck-title';
        deckTitle.textContent = deck.deckName + ' - ' + deck.author;
        deckDiv.appendChild(deckTitle);

        // Create card list container (ul)
        const cardList = document.createElement('ul');
        cardList.className = 'card-list';
        cardList.style.display = 'none'; // collapsed by default

        // Group cards by type (optional)
        let lastType = null;
        deck.cards.forEach(card => {
          if(card.type && card.type !== lastType){
            const typeHeader = document.createElement('li');
            typeHeader.innerHTML = '<strong>' + card.type.toUpperCase() + '</strong>';
            cardList.appendChild(typeHeader);
            lastType = card.type;
          }
          // Create card li
          const li = document.createElement('li');
          li.textContent = '1 ' + card.name; // You can add quantity if you want
          li.style.cursor = 'pointer';
          li.onclick = () => showCardImage(null, card.name);
          cardList.appendChild(li);
        });

        deckDiv.appendChild(cardList);
        container.appendChild(deckDiv);

        // Toggle show/hide cards on title click
        deckTitle.addEventListener('click', () => {
          if(cardList.style.display === 'none'){
            cardList.style.display = 'block';
            deckTitle.textContent = deck.deckName + ' - ' + deck.author + ' â–²';
          } else {
            cardList.style.display = 'none';
            deckTitle.textContent = deck.deckName + ' - ' + deck.author + ' â–¼';
          }
        });

        // Initialize with arrow down
        deckTitle.textContent += ' â–¼';
      });
    } catch (err) {
      console.error('Error loading decks:', err);
    }
  }

  // Load decks when page loads
  window.addEventListener('DOMContentLoaded', loadDecks);
</script>

</body>
</html>
